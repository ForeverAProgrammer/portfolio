"use strict";(globalThis.webpackChunkmy_profile_site=globalThis.webpackChunkmy_profile_site||[]).push([[1746],{15256:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>a,contentTitle:()=>l,default:()=>p,frontMatter:()=>o,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"design-patterns/creational/prototype","title":"Prototype Pattern","description":"Specify the kinds of objects to create using a prototypical instance, and create new objects by copying this prototype.","source":"@site/docs/design-patterns/creational/prototype.md","sourceDirName":"design-patterns/creational","slug":"/design-patterns/creational/prototype","permalink":"/docs/design-patterns/creational/prototype","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":5,"frontMatter":{"sidebar_position":5},"sidebar":"tutorialSidebar","previous":{"title":"Builder Pattern","permalink":"/docs/design-patterns/creational/builder"},"next":{"title":"Behavioral Patterns","permalink":"/docs/design-patterns/behavioral/"}}');var i=t(74848),s=t(28453);const o={sidebar_position:5},l="Prototype Pattern",a={},c=[{value:"Problem",id:"problem",level:2},{value:"Design Principles Applied",id:"design-principles-applied",level:2},{value:"Shallow vs Deep Copy",id:"shallow-vs-deep-copy",level:2},{value:"UML Diagram",id:"uml-diagram",level:2},{value:"Implementation",id:"implementation",level:2},{value:"Example 1: Shape Registry",id:"example-1-shape-registry",level:3},{value:"Step 1: Define the Prototype Interface",id:"step-1-define-the-prototype-interface",level:3},{value:"Step 2: Create Concrete Prototypes",id:"step-2-create-concrete-prototypes",level:3},{value:"Step 3: Create a Prototype Registry",id:"step-3-create-a-prototype-registry",level:3},{value:"Step 4: Client Usage",id:"step-4-client-usage",level:3},{value:"Example 2: Deep Copy with Nested Objects",id:"example-2-deep-copy-with-nested-objects",level:2},{value:"Java&#39;s Built-in Cloneable",id:"javas-built-in-cloneable",level:2},{value:"Real-World Examples",id:"real-world-examples",level:2},{value:"Prototype vs Similar Patterns",id:"prototype-vs-similar-patterns",level:2}];function d(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",mermaid:"mermaid",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"prototype-pattern",children:"Prototype Pattern"})}),"\n",(0,i.jsx)(n.p,{children:"Specify the kinds of objects to create using a prototypical instance, and create new objects by copying this prototype."}),"\n",(0,i.jsx)(n.h2,{id:"problem",children:"Problem"}),"\n",(0,i.jsx)(n.p,{children:"You need to create new objects that are copies of existing ones, but the class to instantiate is unknown at compile time, or creating an object from scratch is expensive compared to copying an existing one."}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Common Scenarios:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Copying complex objects that are expensive to initialise (e.g. objects loaded from a database)"}),"\n",(0,i.jsx)(n.li,{children:"Creating objects whose type is determined at runtime"}),"\n",(0,i.jsx)(n.li,{children:"Reducing subclass explosion when only state differs between instances"}),"\n",(0,i.jsx)(n.li,{children:"Implementing undo by cloning object state before changes"}),"\n",(0,i.jsx)(n.li,{children:"Game object spawning (clone a template enemy or projectile)"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"design-principles-applied",children:"Design Principles Applied"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Encapsulation"})," - The object knows how to clone itself; callers don't need to know its internals"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Open/Closed Principle"})," - Add new types by registering new prototypes, not modifying existing code"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Favour composition"})," - Cloning avoids hard-coding the concrete class being created"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"shallow-vs-deep-copy",children:"Shallow vs Deep Copy"}),"\n",(0,i.jsx)(n.p,{children:"The most important implementation decision when using Prototype:"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Copy type"}),(0,i.jsx)(n.th,{children:"What it copies"}),(0,i.jsx)(n.th,{children:"Risk"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Shallow"})}),(0,i.jsx)(n.td,{children:"Copies field values; object references are shared"}),(0,i.jsx)(n.td,{children:"Clones share mutable referenced objects"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Deep"})}),(0,i.jsx)(n.td,{children:"Recursively copies all referenced objects"}),(0,i.jsx)(n.td,{children:"Safe, but more complex to implement"})]})]})]}),"\n",(0,i.jsx)(n.h2,{id:"uml-diagram",children:"UML Diagram"}),"\n",(0,i.jsx)(n.mermaid,{value:'classDiagram\n    class Prototype {\n        <<interface>>\n        +clone() Prototype\n    }\n    class ConcretePrototype1 {\n        -field1\n        +clone() Prototype\n    }\n    class ConcretePrototype2 {\n        -field2\n        +clone() Prototype\n    }\n    class Client {\n        <<actor>>\n    }\n    note for Client "Represents any code that uses the pattern, not a concrete class"\n    Client --\x3e Prototype\n    Prototype <|.. ConcretePrototype1 : implements\n    Prototype <|.. ConcretePrototype2 : implements'}),"\n",(0,i.jsx)(n.h2,{id:"implementation",children:"Implementation"}),"\n",(0,i.jsx)(n.h3,{id:"example-1-shape-registry",children:"Example 1: Shape Registry"}),"\n",(0,i.jsx)(n.p,{children:"A registry of pre-configured shape prototypes that can be cloned on demand."}),"\n",(0,i.jsx)(n.h3,{id:"step-1-define-the-prototype-interface",children:"Step 1: Define the Prototype Interface"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:"public interface Shape {\n    Shape clone();\n    void draw();\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"step-2-create-concrete-prototypes",children:"Step 2: Create Concrete Prototypes"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:'public class Circle implements Shape {\n    private int radius;\n    private String color;\n\n    public Circle(int radius, String color) {\n        this.radius = radius;\n        this.color = color;\n    }\n\n    // Copy constructor used by clone()\n    private Circle(Circle source) {\n        this.radius = source.radius;\n        this.color = source.color;\n    }\n\n    @Override\n    public Shape clone() {\n        return new Circle(this);\n    }\n\n    public void setRadius(int radius) { this.radius = radius; }\n\n    @Override\n    public void draw() {\n        System.out.println("Drawing Circle [radius=" + radius + ", color=" + color + "]");\n    }\n}\n\npublic class Rectangle implements Shape {\n    private int width;\n    private int height;\n    private String color;\n\n    public Rectangle(int width, int height, String color) {\n        this.width = width;\n        this.height = height;\n        this.color = color;\n    }\n\n    private Rectangle(Rectangle source) {\n        this.width = source.width;\n        this.height = source.height;\n        this.color = source.color;\n    }\n\n    @Override\n    public Shape clone() {\n        return new Rectangle(this);\n    }\n\n    @Override\n    public void draw() {\n        System.out.println("Drawing Rectangle [" + width + "x" + height\n            + ", color=" + color + "]");\n    }\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"step-3-create-a-prototype-registry",children:"Step 3: Create a Prototype Registry"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:'// Registry stores named prototypes and clones them on request\npublic class ShapeRegistry {\n    private final Map<String, Shape> prototypes = new HashMap<>();\n\n    public void register(String key, Shape prototype) {\n        prototypes.put(key, prototype);\n    }\n\n    public Shape get(String key) {\n        Shape prototype = prototypes.get(key);\n        if (prototype == null) throw new IllegalArgumentException("Unknown prototype: " + key);\n        return prototype.clone();\n    }\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"step-4-client-usage",children:"Step 4: Client Usage"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:'ShapeRegistry registry = new ShapeRegistry();\nregistry.register("small-red-circle",   new Circle(5, "red"));\nregistry.register("large-blue-rect",    new Rectangle(100, 50, "blue"));\n\n// Clone without knowing the concrete class\nShape c1 = registry.get("small-red-circle");\nShape c2 = registry.get("small-red-circle"); // independent copy\n\nc1.draw(); // Drawing Circle [radius=5, color=red]\nc2.draw(); // Drawing Circle [radius=5, color=red]\n\nSystem.out.println(c1 == c2); // false \u2014 they are separate objects\n'})}),"\n",(0,i.jsx)(n.h2,{id:"example-2-deep-copy-with-nested-objects",children:"Example 2: Deep Copy with Nested Objects"}),"\n",(0,i.jsx)(n.p,{children:"When the object holds references to other mutable objects, a shallow copy is dangerous."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:'public class UserProfile implements Cloneable {\n    private String name;\n    private List<String> roles; // mutable \u2014 must be deep copied\n\n    public UserProfile(String name, List<String> roles) {\n        this.name = name;\n        this.roles = roles;\n    }\n\n    // Shallow clone \u2014 DANGEROUS: both objects share the same roles list\n    public UserProfile shallowClone() {\n        try {\n            return (UserProfile) super.clone();\n        } catch (CloneNotSupportedException e) {\n            throw new RuntimeException(e);\n        }\n    }\n\n    // Deep clone \u2014 safe: each object has its own roles list\n    public UserProfile deepClone() {\n        return new UserProfile(this.name, new ArrayList<>(this.roles));\n    }\n\n    public List<String> getRoles() { return roles; }\n    public String getName() { return name; }\n}\n\n// Demonstrating the difference\nUserProfile original = new UserProfile("Alice", new ArrayList<>(List.of("admin", "editor")));\n\nUserProfile shallow = original.shallowClone();\nshallow.getRoles().add("viewer"); // also modifies original\'s list!\nSystem.out.println(original.getRoles()); // [admin, editor, viewer] \u2014 unexpected!\n\nUserProfile deep = original.deepClone();\ndeep.getRoles().add("guest"); // only modifies deep\'s list\nSystem.out.println(original.getRoles()); // [admin, editor, viewer] \u2014 unchanged\n'})}),"\n",(0,i.jsx)(n.h2,{id:"javas-built-in-cloneable",children:"Java's Built-in Cloneable"}),"\n",(0,i.jsxs)(n.p,{children:["Java provides ",(0,i.jsx)(n.code,{children:"Object.clone()"})," and the ",(0,i.jsx)(n.code,{children:"Cloneable"})," marker interface, but there are well-known pitfalls:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:"// Java's Cloneable approach (use with caution)\npublic class Point implements Cloneable {\n    private int x, y;\n\n    public Point(int x, int y) { this.x = x; this.y = y; }\n\n    @Override\n    public Point clone() {\n        try {\n            return (Point) super.clone(); // performs shallow copy\n        } catch (CloneNotSupportedException e) {\n            throw new AssertionError(); // can't happen if Cloneable is implemented\n        }\n    }\n}\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsxs)(n.strong,{children:["Prefer copy constructors or factory methods over ",(0,i.jsx)(n.code,{children:"Cloneable"})]})," \u2014 ",(0,i.jsx)(n.code,{children:"Object.clone()"})," bypasses constructors, can silently produce shallow copies, and the ",(0,i.jsx)(n.code,{children:"Cloneable"})," interface provides no ",(0,i.jsx)(n.code,{children:"clone()"})," method to implement against."]}),"\n",(0,i.jsx)(n.h2,{id:"real-world-examples",children:"Real-World Examples"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.code,{children:"Object.clone()"})})," \u2014 Java's built-in shallow copy mechanism"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsxs)(n.strong,{children:["Spring ",(0,i.jsx)(n.code,{children:"BeanDefinition"})]}),' \u2014 bean definitions are prototyped (scope="prototype") to create new instances per request']}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsxs)(n.strong,{children:[(0,i.jsx)(n.code,{children:"ArrayList"})," copy constructor"]})," \u2014 ",(0,i.jsx)(n.code,{children:"new ArrayList<>(existingList)"})," is a prototype-style shallow copy"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Figma / design tools"})," \u2014 duplicating a component creates an independent clone of the prototype"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"prototype-vs-similar-patterns",children:"Prototype vs Similar Patterns"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Pattern"}),(0,i.jsx)(n.th,{children:"Intent"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Prototype"})}),(0,i.jsx)(n.td,{children:"Create new objects by cloning an existing instance"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Factory Method"})}),(0,i.jsx)(n.td,{children:"Create objects through a subclass-defined factory method"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Abstract Factory"})}),(0,i.jsx)(n.td,{children:"Create families of related objects through a factory interface"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Memento"})}),(0,i.jsx)(n.td,{children:"Captures state for restoration; not intended for creating new working objects"})]})]})]})]})}function p(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},28453:(e,n,t)=>{t.d(n,{R:()=>o,x:()=>l});var r=t(96540);const i={},s=r.createContext(i);function o(e){const n=r.useContext(s);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),r.createElement(s.Provider,{value:n},e.children)}}}]);